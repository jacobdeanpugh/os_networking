import hashlib
import os
import requests
from .config import config

def generate_file_sha256(file):
    m = hashlib.sha256()
    try:
        m.update(file)
        return m.hexdigest()
    except Exception as e:
        print("Error Occured Hashing File: ", e)

def query_file_hash(file_hash):
    key = config["signatures"]['malware_bazzar_api_key']
    endpoint = config["signatures"]['malware_bazzar_endpoint']

    headers = {
        "Auth-Key": key
    }
    data = {
        "query": "get_info",
        "hash" : file_hash
    }

    response = requests.post(endpoint, headers=headers, data=data)
    try:
        response.raise_for_status()
    except Exception as e:
        print("Error Occured Querying File Hash: ", e)
    
    return response
