import logging
import os
from .config import config

# Get Log Settings
log_file = config["logger"]["log_file"]
log_level = config["logger"]["log_level"]
log_format = config["logger"]["log_format"]

# Ensure log directory exists
log_dir = os.path.dirname(log_file)
if log_dir and not os.path.exists(log_dir):
    os.makedirs(log_dir)

# Set up logging
logging.basicConfig(
    filename=log_file,
    level = getattr(logging, log_level.upper(), logging.INFO),
    format=log_format,
    datefmt="%Y-%m-%d %H:%M:%S"
)

# Create instance
logger = logging.getLogger("malware_detector")

# Log errors to the console
console_handler = logging.StreamHandler()
console_handler.setLevel(logging.ERROR)
console_handler.setFormatter(logging.Formatter(log_format))
logger.addHandler(console_handler)